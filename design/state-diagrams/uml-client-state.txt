@startuml

[*] -> Disconnected
Connected --> Disconnected : [Connection terminated]
Disconnected --> Connected : [Connection made]
Disconnected : Transactions fail
Disconnected -> [*] : [Context destroyed]

state Connected {

	[*] --> Ready 
	Ready : Transactions can be created
	Ready --> [*] : [disconnect called]

	--

	[*] --> Uncommitted : [New transaction]
	Uncommitted --> Pending : [Transaction::commit()]
	note top of Uncommitted : Every transaction is a distinct state	
	Uncommitted --> Aborted : [Transaction::abort()]
	Pending --> Aborted : [commit fails]
	Aborted --> [*] : [Transaction destroyed]
	Pending --> Committed : [commit succeeds]
	Committed --> [*] : [Transaction destroyed]
}

@enduml